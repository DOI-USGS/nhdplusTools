<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to nhdplusTools • nhdplusTools</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to nhdplusTools">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nhdplusTools</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nhdplusTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/point_indexing.html">NHDPlus Indexing</a>
    </li>
    <li>
      <a href="../articles/refactor_nhdplus.html">NHDPlus Refactor</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dblodgett-usgs/nhdplusTools#readme">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to nhdplusTools</h1>
                        <h4 class="author"><a href="mailto:dblodgett@usgs.gov">dblodgett@usgs.gov</a></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dblodgett-usgs/nhdplusTools#readme/blob/master/vignettes/nhdplusTools.Rmd"><code>vignettes/nhdplusTools.Rmd</code></a></small>
      <div class="hidden name"><code>nhdplusTools.Rmd</code></div>

    </div>

    
    
<p>The <code>nhdplusTools</code> package is intended to provide a reusable set of tools to subset, relate data to, and refactor NHDPlus data. It implements a data model consistent with both the <a href="https://www.epa.gov/waterdata/nhdplus-national-hydrography-dataset-plus">NHDPlus</a> and <a href="http://opengeospatial.github.io/HY_Features/">HY_Features</a>. The package aims to provide a simple set of tools with minimal dependencies that can be used to build workflows using NHDPlus data.</p>
<p>The package has three types of functionality:</p>
<ol style="list-style-type: decimal">
<li><a href="#discovery_subsetting">Discovery and Subsetting</a></li>
<li><a href="#indexing">Indexing or Referencing</a></li>
<li><a href="#refactoring">Generalization and Refactoring</a></li>
</ol>
<p>This introduction gives an overview of the basic package setup and an brief demonstration of the three types of functionality. Detailed documentation of all the package functions can be found at the <a href="https://dblodgett-usgs.github.io/nhdplusTools/reference/">Referece page</a></p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The easiest way to install <code>nhdplusTools</code> is with the <code>devtools</code> packagelike this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(dblodgett<span class="op">-</span>usgs<span class="op">/</span>nhdplusTools)</code></pre></div>
<p>Then you can load up nhdplusTools:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nhdplusTools)
<span class="co">#&gt; USGS Support Package: https://owi.usgs.gov/R/packages.html#support</span></code></pre></div>
</div>
<div id="data-and-package-basics" class="section level2">
<h2 class="hasAnchor">
<a href="#data-and-package-basics" class="anchor"></a>Data and Package Basics</h2>
<p>The first thing you are going to need to do is go get some data to work with. You can download the <a href="https://www.epa.gov/waterdata/nhdplus-national-data">National Seamless database at this web page.</a> You will need <a href="https://www.7-zip.org/">7z</a> or the <a href="https://github.com/jimhester/archive"><code>archive</code> package</a> to extract it.</p>
<p>Once you have it downloaded and extracted, you can tell the nhdplusTools package where it is with the <code><a href="../reference/nhdplus_path.html">nhdplus_path()</a></code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/nhdplus_path.html">nhdplus_path</a></span>(<span class="st">"data_dir/natseamless.gpkg"</span>)

<span class="kw"><a href="../reference/nhdplus_path.html">nhdplus_path</a></span>()
<span class="co">#&gt; [1] "data_dir/natseamless.gpkg"</span></code></pre></div>
<p>If you are going to be loading and reloading the flowlines, flowline attributes, or catchments, repeatadly, the <code><a href="../reference/stage_national_data.html">stage_national_data()</a></code> function will speed things up a bit. It creates three staged files that are quicker for R to read at the path you tell it. If you call it and its output files exist, it won’t overwrite and just return the paths to your staged files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">staged_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/stage_national_data.html">stage_national_data</a></span>()
<span class="co">#&gt; Warning in stage_national_data(): No output path provided, using: data_dir</span>

<span class="kw">str</span>(staged_data)
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ attributes: chr "data_dir/nhdplus_flowline_attributes.rds"</span>
<span class="co">#&gt;  $ flowline  : chr "data_dir/nhdplus_flowline.rds"</span>
<span class="co">#&gt;  $ catchment : chr "data_dir/nhdplus_catchment.rds"</span></code></pre></div>
<p>As you can see, <code><a href="../reference/stage_national_data.html">stage_national_data()</a></code> assumes you want to stage data in the same folder as the nhdplus_path database and returns a list of .rds files that can be read with readRDS. The flowlines and catchments are <a href="https://r-spatial.github.io/sf/"><code>sf</code></a> <code>data.frame</code>s and attributes is a plain <code>data.frame</code> with the attributes from <code>flowline</code>. Note that this introduction uses a small subset of the national seamless database as shown in the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flowline &lt;-<span class="st"> </span><span class="kw">readRDS</span>(staged_data<span class="op">$</span>flowline)
<span class="kw">names</span>(flowline)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
<span class="co">#&gt;  [1] "COMID"      "FDATE"      "RESOLUTION" "GNIS_ID"    "GNIS_NAME" </span>
<span class="co">#&gt;  [6] "LENGTHKM"   "REACHCODE"  "FLOWDIR"    "WBAREACOMI" "FTYPE"</span>

<span class="kw">library</span>(sf)
<span class="co">#&gt; Linking to GEOS 3.6.1, GDAL 2.1.3, proj.4 4.9.3</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(flowline[[<span class="kw">attr</span>(flowline, <span class="st">"sf_column"</span>)]])</code></pre></div>
<p><img src="nhdplusTools_files/figure-html/staged_data-1.png" width="576"><a id="discovery_subsetting"></a></p>
</div>
<div id="discovery-and-subsetting" class="section level2">
<h2 class="hasAnchor">
<a href="#discovery-and-subsetting" class="anchor"></a>Discovery and Subsetting</h2>
<p>One of the primary workflows <code>nhdplusTools</code> is designed to accomplish can be described in three steps:</p>
<ol style="list-style-type: decimal">
<li>what NHDPlus catchment is at the outlet of a watershed,</li>
<li>figure out what catchments are up or downstream of that catchment, and</li>
<li>create a stand alone subset for that collection of catchments.</li>
</ol>
<p>Say we want to get a subset of the NHDPlus upstream of a given location. We can start with <code><a href="../reference/discover_nhdplus_id.html">discover_nhdplus_id()</a></code> First, let’s look at a given point location. Then see where it is relative to our flowlines.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lon &lt;-<span class="st"> </span><span class="op">-</span><span class="fl">89.362239</span>
lat &lt;-<span class="st"> </span><span class="fl">43.090266</span>

start_point &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/sfc">st_sfc</a></span>(sf<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/st">st_point</a></span>(<span class="kw">c</span>(lon, lat)),
                          <span class="dt">crs =</span> <span class="dv">4269</span>)

geom_col &lt;-<span class="st"> </span><span class="kw">attr</span>(flowline, <span class="st">"sf_column"</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(flowline[[geom_col]])
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(start_point, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="nhdplusTools_files/figure-html/point-1.png" width="576"></p>
<p>OK, so we have a point location near a river and we want to figure out what catchment is out outlet. We can use the <code><a href="../reference/discover_nhdplus_id.html">discover_nhdplus_id()</a></code> function which calls out to a web service and returns an NHDPlus catchment identifier, commonly called a COMID.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">start_comid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/discover_nhdplus_id.html">discover_nhdplus_id</a></span>(start_point)
start_comid
<span class="co">#&gt; [1] 13293750</span></code></pre></div>
<p>With that starting COMID, we can use one of the network navigation functions, <code>get_UM</code>, <code>get_UT</code>, <code>get_DM</code>, or <code>get_DD</code> to retrieve a collection of comids along the upstream mainstaem, upstream with tributaries, downstream mainstem, or downstream with diversions network paths. Here we’ll use upstream with tributaries.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">UT_comids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_UT.html">get_UT</a></span>(flowline, start_comid)
UT_comids
<span class="co">#&gt;   [1]  13293750  13294312  13294308  13294310  13293634  13294304  13294314</span>
<span class="co">#&gt;   [8]  13293696  13294368  13294298  13294300  13293690  13293694  13294290</span>
<span class="co">#&gt;  [15]  13294292  13294294  13294296  13294306  13294264  13293692  13294176</span>
<span class="co">#&gt;  [22]  13294166  13293588  13293576  13294184  13293676  13293678  13294174</span>
<span class="co">#&gt;  [29]  13294168  13293548  13293554  13293572  13293574  13294288  13293620</span>
<span class="co">#&gt;  [36]  13293624  13293688  13293672  13294178  13293578  13293600  13293590</span>
<span class="co">#&gt;  [43]  13294282  13293568  13293552  13293550  13293570  13294286  13294284</span>
<span class="co">#&gt;  [50]  13293612  13293614  13293674  13293646  13293562  13293564  13293540</span>
<span class="co">#&gt;  [57]  13293556  13293558  13294158  13294280  13293584  13293586  13293520</span>
<span class="co">#&gt;  [64]  13293518  13293556  13294154  13293506  13294152  13293504  13293480</span>
<span class="co">#&gt;  [71]  13293472  13293508  13294150  13293542  13294134  13293478  13294132</span>
<span class="co">#&gt;  [78]  13293514  13293532  13294148  13294138  13293536  13293494  13294130</span>
<span class="co">#&gt;  [85]  13294128  13293476  13294120  13293530  13294144  13294150  13293524</span>
<span class="co">#&gt;  [92]  13293516  13293496  13293502  13293492 937090091  13294394  13293450</span>
<span class="co">#&gt;  [99]  13293448  13293522  13293526  13293532  13294140  13293488  13293486</span>
<span class="co">#&gt; [106]  13294382 937090090  13293454  13293442  13294116  13293524  13293516</span>
<span class="co">#&gt; [113]  13293484  13293498  13294274  13293456  13294124  13293430  13294140</span>
<span class="co">#&gt; [120]  13293458  13293432  13293452  13293462  13293464  13294384  13293424</span>
<span class="co">#&gt; [127]  13293422  13293452  13294114  13293428  13293438  13293444  13294276</span>
<span class="co">#&gt; [134]  13302588  13294110  13293512  13293416  13293418  13293420  13294270</span>
<span class="co">#&gt; [141]  13294272  13294386  13293398  13293474  13293460  13293400  13293410</span>
<span class="co">#&gt; [148]  13293412  13294278  13302590  13293392  13294118  13294122  13293394</span>
<span class="co">#&gt; [155]  13293404  13293490  13293446  13293388  13293440  13293468  13293390</span>
<span class="co">#&gt; [162]  13293396  13294268  13293436  13293434  13293384  13293426  13294112</span>
<span class="co">#&gt; [169]  13293386  13293406  13293404  13293380  13293382  13293378  13293376</span>
<span class="co">#&gt; [176]  13294268  13294366  13293406  13294366</span></code></pre></div>
<p>If you are familiar with the NHDPlus, you will recognize that now that we have this list of COMIDs, we could go off and do all sorts of things with the various flowline attribtues. For now, let’s just use the COMID list to filter our <code>fline</code> <code>sf</code> <code>data.frame</code> and plot it with our other layers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(flowline[[geom_col]])
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(start_point, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(flowline, COMID <span class="op">%in%</span><span class="st"> </span>UT_comids)[[geom_col]],
     <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="nhdplusTools_files/figure-html/plot_fline_subset-1.png" width="576"></p>
<p>Say you want to save the network subset for later use in R or in some other GIS. The `subset_nhdplus() function is your friend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output_file &lt;-<span class="st"> "./data_dir/subset.gpkg"</span>

output_file &lt;-<span class="kw"><a href="../reference/subset_nhdplus.html">subset_nhdplus</a></span>(<span class="dt">comids =</span> UT_comids,
                             <span class="dt">output_file =</span> output_file,
                             <span class="dt">nhdplus_data_path =</span> <span class="kw"><a href="../reference/nhdplus_path.html">nhdplus_path</a></span>(),
                             <span class="dt">intersection_crs =</span> sf<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/st_crs">st_crs</a></span>(<span class="st">"+init=epsg:5070"</span>))
<span class="co">#&gt; Reading NHDFlowline_Network</span>
<span class="co">#&gt; Writing NHDFlowline_Network</span>
<span class="co">#&gt; Reading CatchmentSP</span>
<span class="co">#&gt; Writing CatchmentSP</span>
<span class="co">#&gt; Reading Gage</span>
<span class="co">#&gt; Writing Gage</span>
<span class="co">#&gt; Reading Sink</span>
<span class="co">#&gt; Writing Sink</span>
<span class="co">#&gt; Reading NHDArea</span>
<span class="co">#&gt; Writing NHDArea</span>
<span class="co">#&gt; Reading NHDWaterbody</span>
<span class="co">#&gt; Writing NHDWaterbody</span>
<span class="co">#&gt; Reading NHDFlowline_NonNetwork</span>
<span class="co">#&gt; Writing NHDFlowline_NonNetwork</span>

sf<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/st_layers">st_layers</a></span>(output_file)
<span class="co">#&gt; Driver: GPKG </span>
<span class="co">#&gt; Available layers:</span>
<span class="co">#&gt;               layer_name     geometry_type features fields</span>
<span class="co">#&gt; 1    NHDFlowline_Network Multi Line String      168    136</span>
<span class="co">#&gt; 2            CatchmentSP     Multi Polygon      167      6</span>
<span class="co">#&gt; 3                   Gage             Point       33     19</span>
<span class="co">#&gt; 4                   Sink                          0      9</span>
<span class="co">#&gt; 5                NHDArea     Multi Polygon        1     14</span>
<span class="co">#&gt; 6           NHDWaterbody     Multi Polygon       90     21</span>
<span class="co">#&gt; 7 NHDFlowline_NonNetwork Multi Line String       45     12</span></code></pre></div>
<p>Now we have an output geopackage that can be used later. It contains the network subset of catchments and flowlines as well as a spatial subset of other laters as shown in the status output above. To complete the demonstration, here are a couple more layers plotted up.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">catchment &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/st_read">read_sf</a></span>(output_file, <span class="st">"CatchmentSP"</span>)
waterbody &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/st_read">read_sf</a></span>(output_file, <span class="st">"NHDWaterbody"</span>)

<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(flowline[[geom_col]])
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(start_point, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(flowline, COMID <span class="op">%in%</span><span class="st"> </span>UT_comids)[[geom_col]],
     <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(catchment[[geom_col]], <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(waterbody[[geom_col]], <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="nhdplusTools_files/figure-html/plot_result-1.png" width="576"><a id="indexing"></a></p>
</div>
<div id="indexing" class="section level2">
<h2 class="hasAnchor">
<a href="#indexing" class="anchor"></a>Indexing</h2>
<p>Expect more in this space as <code>nhdplustTools</code> progresses. Right now, one indexing method has been implemented. Using the data above, we can use the <code><a href="../reference/get_flowline_index.html">get_flowline_index()</a></code> function to get the comid, reachcode, and measure of our starting point like this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_flowline_index.html">get_flowline_index</a></span>(flowline, start_point)
<span class="co">#&gt;      COMID      REACHCODE REACH_meas</span>
<span class="co">#&gt; 1 13293750 07090002007373   53.13861</span></code></pre></div>
<p><code><a href="../reference/get_flowline_index.html">get_flowline_index()</a></code> will work with a list of points too. For demonstration purposes, we can use the gages in our subset from above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gage &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sf/topics/st_read">read_sf</a></span>(output_file, <span class="st">"Gage"</span>)

geom_col &lt;-<span class="st"> </span><span class="kw">attr</span>(gage, <span class="st">"sf_column"</span>)
<span class="kw"><a href="../reference/get_flowline_index.html">get_flowline_index</a></span>(flowline, gage[[geom_col]], <span class="dt">precision =</span> <span class="dv">10</span>)
<span class="co">#&gt;       COMID      REACHCODE  REACH_meas</span>
<span class="co">#&gt; 1  13293744 07090002007743  29.3045252</span>
<span class="co">#&gt; 2  13294276 07090002008387  14.8355105</span>
<span class="co">#&gt; 3  13294264 07090002007650  56.4438696</span>
<span class="co">#&gt; 4  13293750 07090002007373  42.5089435</span>
<span class="co">#&gt; 5  13294312 07090002008383   1.2211441</span>
<span class="co">#&gt; 6  13294264 07090002007650  41.0519403</span>
<span class="co">#&gt; 7  13294264 07090002007650   2.0871734</span>
<span class="co">#&gt; 8  13293688 07090002007660 100.0000000</span>
<span class="co">#&gt; 9  13294300 07090002008379  85.4440745</span>
<span class="co">#&gt; 10 13293690 07090002007648   0.7642491</span>
<span class="co">#&gt; 11 13294264 07090002007650  71.4042342</span>
<span class="co">#&gt; 12 13294264 07090002007650  72.0019381</span>
<span class="co">#&gt; 13 13294176 07090002007664   6.1174271</span>
<span class="co">#&gt; 14 13294264 07090002007650  29.9935507</span>
<span class="co">#&gt; 15 13294290 07090002008374  88.0212984</span>
<span class="co">#&gt; 16 13294138 07090002007709  73.3716682</span>
<span class="co">#&gt; 17 13293614 07090002007657 100.0000000</span>
<span class="co">#&gt; 18 13293486 07090002007724   8.8530113</span>
<span class="co">#&gt; 19 13293512 07090002007723   5.9867618</span>
<span class="co">#&gt; 20 13294176 07090002007664  16.9958260</span>
<span class="co">#&gt; 21 13293892 07090002007769  76.2138002</span>
<span class="co">#&gt; 22 13293474 07090002007713  72.0813909</span>
<span class="co">#&gt; 23 13293520 07090002007676  18.1942138</span>
<span class="co">#&gt; 24 13293876 07090002007627  60.1357174</span>
<span class="co">#&gt; 25 13293826 07090002007632 100.0000000</span>
<span class="co">#&gt; 26 13293512 07090002007723  68.1716181</span>
<span class="co">#&gt; 27 13294264 07090002007650  97.1673437</span>
<span class="co">#&gt; 28 13294344 07090002007629   6.5787509</span>
<span class="co">#&gt; 29 13293452 07090002007737   0.0000000</span>
<span class="co">#&gt; 30 13294344 07090002007629  27.7299659</span>
<span class="co">#&gt; 31 13293512 07090002007723  67.6223334</span>
<span class="co">#&gt; 32 13294344 07090002007629   6.5787509</span>
<span class="co">#&gt; 33 13294288 07090002008236   4.3378700</span></code></pre></div>
<p>For more info about <code><a href="../reference/get_flowline_index.html">get_flowline_index()</a></code> see the article <code><a href="../articles/point_indexing.html">vignette("point_indexing")</a></code> about it or the reference page that describes it.</p>
<p><a id="refactoring"></a></p>
</div>
<div id="refactoring" class="section level2">
<h2 class="hasAnchor">
<a href="#refactoring" class="anchor"></a>Refactoring</h2>
<p>The refactoring functionality is described in full in the article <code><a href="../articles/refactor_nhdplus.html">vignette("refactor_nhdplus")</a></code> about it.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#data-and-package-basics">Data and Package Basics</a></li>
      <li><a href="#discovery-and-subsetting">Discovery and Subsetting</a></li>
      <li><a href="#indexing">Indexing</a></li>
      <li><a href="#refactoring">Refactoring</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by David Blodgett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
