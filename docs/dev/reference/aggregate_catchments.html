<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Aggregate Catchments — aggregate_catchments • nhdplusTools</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Aggregate Catchments — aggregate_catchments" />

<meta property="og:description" content="Aggregates catchments according to a set of outlet catchments." />
<meta name="twitter:card" content="summary" />

<meta name="robots" content="noindex">

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nhdplusTools</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development package">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nhdplusTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/plot_nhdplus.html">Plotting with nhdplusTools</a>
    </li>
    <li>
      <a href="../articles/point_indexing.html">Indexing / Referencing</a>
    </li>
    <li>
      <a href="../articles/refactor_catchment.html">Refactor Catchments</a>
    </li>
    <li>
      <a href="../articles/refactor_nhdplus.html">Refactor Flowlines</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dblodgett-usgs/nhdplusTools#readme">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregate Catchments</h1>
    <small class="dont-index">Source: <a href='https://github.com/dblodgett-usgs/nhdplusTools#readme/blob/master/R/aggregate_catchments.R'><code>R/aggregate_catchments.R</code></a></small>
    <div class="hidden name"><code>aggregate_catchments.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Aggregates catchments according to a set of outlet catchments.</p>
    
    </div>

    <pre class="usage"><span class='fu'>aggregate_catchments</span>(<span class='no'>fline_rec</span>, <span class='no'>cat_rec</span>, <span class='no'>outlets</span>, <span class='kw'>da_thresh</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>only_larger</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fline_rec</th>
      <td><p>sf data.frame Reconciled flowlines as generated by `refactor_nhdplus`</p></td>
    </tr>
    <tr>
      <th>cat_rec</th>
      <td><p>sf data.frame Reconciled catchments as genberated by `reconcile_catchments`</p></td>
    </tr>
    <tr>
      <th>outlets</th>
      <td><p>data.frame with "ID" and "type" columns. "ID" must be identifiers from
fline and cat data.frames. "type" should be "outlet", or "terminal".
"outlet" will include the specified ID.
"terminal" will be treated as a terminal node with nothing downstream.
This parameter may change.</p></td>
    </tr>
    <tr>
      <th>da_thresh</th>
      <td><p>numeric Defaults to NA. A threshold total drainage area in the units of the TotDASqKM
field of the fline_rec data.frame. When automatically adding confluences to make
the network valid, tributary catchments under this threshold will be lumped with
the larger tributaries rather than being added to the set of output catchments.</p></td>
    </tr>
    <tr>
      <th>only_larger</th>
      <td><p>boolean Defaults to TRUE. If TRUE when adding confluences to
make the network valid, only tributaries larger than the one with an upstream
outlet will be added. e.g. if a tributary is required in the model this will
add main stems that the tributary contributes to. Note that the NHDPlus treats
divergences as part of the main stem, so the da_thresh may still be needed to
eliminate small tributary catchments introduced by divergences near confluences.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function operates on the catchment network as a node-edge graph.
The outlet types are required to ensure that graph searches start from the
appropriate nodes and includes the appropriate catchments. Outlets such as gages
should be treated as "outlet" outlets.
While it may be possible for the algorithm to determine terminal outlets, at this
time, it is required that they be specified explicitely as "terminal" outlet types.</p>
<p>The function checks supplied catchment outlets to make sure they connect to downstream
catchments. Checks verify that the outlet of the levelpath of each supplied outlet is
in the supplied outlet set. If the outlet of a levelpath is not in the supplied set, it
is added along with other catchments that contribute to the same receiving catchment.
These checks ensure that all output catchments have one and only one input and output
nexus and that all catchments are well-connected.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>source</span>(<span class='fu'>system.file</span>(<span class='st'>"extdata"</span>, <span class='st'>"walker_data.R"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"nhdplusTools"</span>))
<span class='no'>outlets</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>ID</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>31</span>, <span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>1</span>, <span class='fl'>45</span>, <span class='fl'>92</span>),
                      <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"outlet"</span>, <span class='st'>"outlet"</span>, <span class='st'>"outlet"</span>, <span class='st'>"terminal"</span>, <span class='st'>"outlet"</span>, <span class='st'>"outlet"</span>),
                      <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>aggregated</span> <span class='kw'>&lt;-</span> <span class='fu'>aggregate_catchments</span>(<span class='no'>walker_fline_rec</span>, <span class='no'>walker_catchment_rec</span>, <span class='no'>outlets</span>)
<span class='fu'>plot</span>(<span class='no'>aggregated</span>$<span class='no'>cat_sets</span>$<span class='no'>geom</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='st'>"red"</span>)</div><div class='input'><span class='fu'>plot</span>(<span class='no'>walker_catchment_rec</span>$<span class='no'>geom</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='st'>"green"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='input'><span class='fu'>plot</span>(<span class='no'>walker_catchment</span>$<span class='no'>geom</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='input'><span class='fu'>plot</span>(<span class='no'>walker_flowline</span>$<span class='no'>geom</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>.7</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='aggregate_catchments-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'>plot</span>(<span class='no'>aggregated</span>$<span class='no'>cat_sets</span>$<span class='no'>geom</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='st'>"black"</span>)</div><div class='input'><span class='fu'>plot</span>(<span class='no'>aggregated</span>$<span class='no'>fline_sets</span>$<span class='no'>geom</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='input'><span class='fu'>plot</span>(<span class='no'>walker_flowline</span>$<span class='no'>geom</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>.7</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='aggregate_catchments-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by David Blodgett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

