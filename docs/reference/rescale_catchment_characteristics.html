<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Rescale Catchment Characteristics — rescale_catchment_characteristics • nhdplusTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Rescale Catchment Characteristics — rescale_catchment_characteristics"><meta property="og:description" content="Given catchment characteristics to retrieve or process will
aggregate and / or split the characteristics according to a lookup table."><meta property="og:image" content="https://doi-usgs.github.io/nhdplusTools/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nhdplusTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/nhdplusTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/indexing.html">Indexing and Referencing</a>
    </li>
    <li>
      <a href="../articles/nhdplushr.html">Working with NHDPlusHR</a>
    </li>
    <li>
      <a href="../articles/plot_nhdplus.html">Plotting with nhdplusTools</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/doi-usgs/nhdplusTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rescale Catchment Characteristics</h1>
    <small class="dont-index">Source: <a href="https://github.com/doi-usgs/nhdplusTools/blob/HEAD/R/rescale_catchments.R" class="external-link"><code>R/rescale_catchments.R</code></a></small>
    <div class="hidden name"><code>rescale_catchment_characteristics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given catchment characteristics to retrieve or process will
aggregate and / or split the characteristics according to a lookup table.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rescale_catchment_characteristics</span><span class="op">(</span></span>
<span>  <span class="va">vars</span>,</span>
<span>  <span class="va">lookup_table</span>,</span>
<span>  refactored_areas <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  catchment_characteristics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  catchment_areas <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>vars</dt>
<dd><p>data.frame containing `characteristic_id` retrieved from
<a href="get_characteristics_metadata.html">get_characteristics_metadata</a> and `summary_statistic` indicating
which summary statistic should be applied to rescale each characteristic.
Accepted values are "sum," "length_weighted_mean," "area_weighted_mean,"
"min," and "max."</p></dd>


<dt>lookup_table</dt>
<dd><p>data.frame containing `id` numeric vector of identifiers
at the desired scale; "comid" is a numeric vector of NHDPlusV2 identifiers;
"member_comid" contains formatted NHDPlusV2 COMIDs indicating that the
catchments in question need to be split. If catchments have not been split,
the columns "comid" and "member_comid" should be identical.</p></dd>


<dt>refactored_areas</dt>
<dd><p>data.frame containing columns "featureid" and "areasqkm."
Used to retrieve adjusted catchment areas in the case of split catchments. If
not provided, either no split catchments can be considered or the `catchment_areas`
parameter is required.</p></dd>


<dt>catchment_characteristics</dt>
<dd><p>data.frame containing columns
"characteristic_id", "comid", "characteristic_value", and "percent_nodata".
If not provided, it will be retrieved from <a href="get_catchment_characteristics.html">get_catchment_characteristics</a>
using the characteristic ids from `vars` and the comids from `lookup_table`.</p></dd>


<dt>catchment_areas</dt>
<dd><p>data.frame containing columns "comid", "areasqkm",
"split_catchment_areasqkm", and "split_area_prop". If not provided, it will
be retrieved from `refactored_areas` and/or <a href="get_vaa.html">get_vaa</a>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>NOTE: Since this algorithm works on catchment characteristics that are
spatial averages, when splitting, the average condition is apportioned evenly
to each split. In some cases, such as with land cover or elevation, this may
not be appropriate and source data should be used to derive new characteristics.
In addition, this function handles catchment areas for split catchments but
makes no adjustments for the length of flowlines in those catchments.
Therefore, requests for length-weighted mean values may not be appropriate
when working with split catchments.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>characteristic_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CAT_IMPV11"</span>,<span class="st">"CAT_BASIN_AREA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   summary_statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"area_weighted_mean"</span>,<span class="st">"sum"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lookup_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10012268</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           comid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4146596</span>, <span class="fl">4147382</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           member_comid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4146596</span>, <span class="fl">4147382</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rescale_catchment_characteristics</span><span class="op">(</span><span class="va">vars</span>, <span class="va">lookup_table</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fstcore package v0.9.14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (OpenMP was not detected, using single threaded mode)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         id areasqkm_sum lengthkm_sum CAT_IMPV11_area_wtd percent_nodata_CAT_BASIN_AREA_…¹ CAT_BASIN_AREA_sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 10<span style="text-decoration: underline;">012</span>268         12.9         6.30                   0                                0               12.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ abbreviated name: ¹​percent_nodata_CAT_BASIN_AREA_area_wtd</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>characteristic_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CAT_ELEV_MIN"</span>,<span class="st">"CAT_ELEV_MAX"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   summary_statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>,<span class="st">"max"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lookup_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10012268</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           comid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4146596</span>, <span class="fl">4147382</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           member_comid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4146596</span>, <span class="fl">4147382</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rescale_catchment_characteristics</span><span class="op">(</span><span class="va">vars</span>, <span class="va">lookup_table</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         id areasqkm_sum lengthkm_sum percent_nodata_CAT_ELEV_MIN_a…¹ percent_nodata_CAT_E…² CAT_ELEV_MIN_min</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 10<span style="text-decoration: underline;">012</span>268         12.9         6.30                               0                      0             531.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ abbreviated names: ¹​percent_nodata_CAT_ELEV_MIN_area_wtd, ²​percent_nodata_CAT_ELEV_MAX_area_wtd</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: CAT_ELEV_MAX_max &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>characteristic_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CAT_EWT"</span>,<span class="st">"CAT_TWI"</span>, <span class="st">"CAT_BASIN_AREA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   summary_statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"area_weighted_mean"</span>, <span class="st">"area_weighted_mean"</span>,<span class="st">"sum"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lookup_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10012268</span>, <span class="fl">10012268</span>, <span class="fl">10024047</span>, <span class="fl">10024048</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           comid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4146596</span>, <span class="fl">4147382</span>, <span class="fl">4147396</span>, <span class="fl">4147396</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           member_comid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4146596"</span>, <span class="st">"4147382"</span>, <span class="st">"4147396.1"</span>, <span class="st">"4147396.2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">comid_areas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>featureid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4146596"</span>, <span class="st">"4147382"</span>, <span class="st">"4147396.1"</span>, <span class="st">"4147396.2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               areasqkm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9558</span>, <span class="fl">11.9790</span>, <span class="fl">6.513294</span>, <span class="fl">1.439999</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rescale_catchment_characteristics</span><span class="op">(</span><span class="va">vars</span>, <span class="va">lookup_table</span>, refactored_areas <span class="op">=</span> <span class="va">comid_areas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         id areasqkm_sum lengthkm_sum CAT_EWT_area_wtd CAT_TWI_area_wtd percent_nodata_CAT_EWT_area_wtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 10<span style="text-decoration: underline;">012</span>268        12.9          6.30           -<span style="color: #BB0000;">25.5</span>              9.59                               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 10<span style="text-decoration: underline;">024</span>047         6.51         4.31           -<span style="color: #BB0000;">24.6</span>              9.07                               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 10<span style="text-decoration: underline;">024</span>048         1.44         4.31            -<span style="color: #BB0000;">5.44</span>             2.00                               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: percent_nodata_CAT_TWI_area_wtd &lt;dbl&gt;, percent_nodata_CAT_BASIN_AREA_area_wtd &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   CAT_BASIN_AREA_sum &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Blodgett, Mike Johnson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

